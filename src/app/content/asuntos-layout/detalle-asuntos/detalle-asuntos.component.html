<div class="d-flex flex-column h-100">
    <ng-container *ngIf="asuntoSeleccionado; else elseTemplate">
        <div class="d-flex flex-column h-100">
            <div class="p-3 border-bottom bg-white w-100 flex-shrink-0">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div class="flex-grow-1 me-3" style="min-width: 0">
                        <h2 class="fw-bold text-truncate">{{ asuntoSeleccionado.noOficio }}</h2>
                        <div class="text-muted small fw-bold ">
                            <span class="tooltip-wrapper " [attr.data-tooltip]="'Fecha de registro'"><i
                                    class="fas fa-calendar-day text-primary"></i></span>
                            Fecha de registro: {{ asuntoSeleccionado.fechaRegistro | fechaMexico}}

                        </div>
                        <div class="text-muted small fw-bold">
                            <span class="tooltip-wrapper " [attr.data-tooltip]="'Fecha de cumplimiento'"><i
                                    class="fas fa-calendar-check text-success "></i></span>
                            Fecha de cumplimiento {{ asuntoSeleccionado.fechaCumplimiento | fechaMexico}}
                        </div>
                    </div>
                    <div class="text-end flex-shrink-0">
                        <div class="d-flex flex-column gap-1">
                            <span class="badge" [ngClass]="this.colors.getEstadoIcon(asuntoSeleccionado.statusAsunto)">
                                <i class="fas" [ngClass]="this.colors.getEstadoIcon(asuntoSeleccionado.statusAsunto)"></i>
                                <span class="ms-1 text-capitalize">{{ asuntoSeleccionado.statusAsunto.replace('_', '
                                    ')
                                    }}</span>
                            </span>
                            <span class="badge" [ngClass]="this.colors.getPrioridadColor(asuntoSeleccionado.prioridad)">
                                <i class="fas fa-star me-1 small"></i>
                                {{ asuntoSeleccionado.prioridad }}
                            </span>
                        </div>
                    </div>
                </div>

                <div class="d-flex gap-2">
                    <button class="btn btn-primary btn-sm" (click)="openConcluirModal()">
                        <i class="fas fa-check-double me-2"></i> Concluir
                    </button>
                    <button class="btn btn-outline-secondary btn-sm">
                        <i class="fas fa-edit me-2"></i> Editar
                    </button>
                </div>
            </div>
            <ul class="nav nav-tabs px-4 pt-3 border-0 nav-fill" role="tablist">
    <li class="nav-item" role="presentation">
        <button class="nav-link text-deep-blue" [class.active]="tabActiva === 'detalles'"
            (click)="tabActiva = 'detalles'; consultarDetallesAsunto(this.asuntoSeleccionado.idAsunto);">
            <i class="fas fa-file-alt me-2"></i> Detalles
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link text-deep-blue" [class.active]="tabActiva === 'expediente'"
            (click)="tabActiva = 'expediente'; consultarExpedienteAsunto(this.asuntoSeleccionado.idAsunto);">
            <i class="fas fa-folder-open me-2"></i> Expediente
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link text-deep-blue" [class.active]="tabActiva === 'turnados'"
            (click)="tabActiva = 'turnados'; consultarTurnadosAsunto(this.asuntoSeleccionado.idAsunto);">
            <i class="fas fa-sync me-2"></i> Turnados
        </button>
    </li>
    <li class="nav-item" role="presentation">
        <button class="nav-link text-deep-blue" [class.active]="tabActiva === 'historial'"
            (click)="tabActiva = 'historial'; consultarHistorialAsunto(this.asuntoSeleccionado.idAsunto);">
            <i class="fas fa-clock me-2"></i> Historial
        </button>
    </li>
</ul>

            <!-- Contenido de tabs con scroll -->
            <div class="flex-grow-1 p-4 overflow-auto">
                <!-- Detalles -->
                <div *ngIf="tabActiva === 'detalles'">
                    <!-- Información General -->
                    <div class="section">
                        <div class="section-header">
                            <i class="fas fa-file-alt"></i>
                            <h6 class="fw-bold mb-0">Información General</h6>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Tipo de Documento:</label>
                                    <div>{{ asuntoSeleccionado.tipoDocumento }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>No. de Oficio:</label>
                                    <div>{{ asuntoSeleccionado.noOficio }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Es Volante:</label>
                                    <div>{{ asuntoSeleccionado.esVolante ? 'Sí' : 'No' }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row" *ngIf="asuntoSeleccionado?.esVolante">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Número de Volante:</label>
                                    <div>{{ asuntoSeleccionado.numeroVolante }}</div>
                                </div>
                            </div>
                        
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Es Guía:</label>
                                    <div>{{ asuntoSeleccionado.esGuia ? 'Sí' : 'No' }}</div>
                                </div>
                            </div>

                            <div class="col-md-4" *ngIf="asuntoSeleccionado?.esGuia">
                                <div class="field">
                                    <label>Número de Guía:</label>
                                    <div>{{ asuntoSeleccionado.numeroGuia }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Tema:</label>
                                    <div>{{ asuntoSeleccionado.Tema }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Fecha de Cumplimiento:</label>
                                    <div>{{ asuntoSeleccionado.fechaCumplimiento | date }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Prioridad:</label>
                                    <div>{{ asuntoSeleccionado.prioridad }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Estatus:</label>
                                    <div>{{ asuntoSeleccionado.statusAsunto }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Usuario que registra:</label>
                                    <div>{{ asuntoSeleccionado.usuarioRegistra }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Unidad Administrativa:</label>
                                    <div>{{ asuntoSeleccionado.unidadAdministrativa }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Fecha de Registro:</label>
                                    <div>{{ asuntoSeleccionado.fechaRegistro | date }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Fecha del Documento:</label>
                                    <div>{{ asuntoSeleccionado.fechaDocumento | date }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12">
                                <div class="field">
                                    <label>Descripción:</label>
                                    <div>{{ asuntoSeleccionado.descripcionAsunto }}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Datos de Recepción -->
                    <div class="section">
                        <div class="section-header">
                            <i class="fas fa-inbox"></i>
                            <h6 class="fw-bold mb-0">Datos de Recepción</h6>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Fecha de Recepción:</label>
                                    <div>{{ asuntoSeleccionado.fechaRecepcion | date }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Remitente:</label>
                                    <div>{{ asuntoSeleccionado.remitenteNombre }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Cargo:</label>
                                    <div>{{ asuntoSeleccionado.remitenteCargo }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Dependencia:</label>
                                    <div>{{ asuntoSeleccionado.remitenteDependencia }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Dirigido a:</label>
                                    <div>{{ asuntoSeleccionado.dirigidoA }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Cargo Dirigido a:</label>
                                    <div>{{ asuntoSeleccionado.dirigidoACargo }}</div>
                                </div>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4">
                                <div class="field">
                                    <label>Dependencia Destino:</label>
                                    <div>{{ asuntoSeleccionado.dirigidoADependencia }}</div>
                                </div>
                            </div>

                            <div class="col-md-4">
                                <div class="field">
                                    <label>Medio:</label>
                                    <div>{{ asuntoSeleccionado.medio }}</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Observaciones -->
                    <div class="section">
                        <div class="section-header">
                            <i class="fas fa-comment-alt"></i>
                            <h6 class="fw-bold mb-0">Observaciones</h6>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="field">
                                    <div>{{ asuntoSeleccionado.observaciones || 'Sin observaciones' }}</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>


                <!-- Expediente -->
                <div *ngIf="tabActiva === 'expediente'">
                    <div class="p-4">
                        <!-- Documento principal -->
                        <div class="mb-4">
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="fw-bold mb-0">Documento Principal</h6>
                                <button class="btn btn-sm btn-outline-success" (click)="openReemplazarModal()">
                                    <i class="fas fa-upload me-2"></i> Reemplazar Documento
                                </button>
                            </div>

                            <div class="card p-3 d-flex flex-row justify-content-between align-items-center">
                                <div class="d-flex align-items-center gap-3">
                                    <i class="fas fa-file-alt fa-2x text-primary"></i>
                                    <div>
                                        <div class="fw-semibold">{{ asuntoSeleccionado.documento.name }}</div>
                                        <div class="text-muted small">
                                            {{ asuntoSeleccionado.documento.type }} • {{
                                            asuntoSeleccionado.documento.size
                                            }}
                                        </div>
                                    </div>
                                </div>
                                <div class="d-flex gap-2">
                                    <button class="btn btn-sm btn-light" (click)="openDocumentoVisor(asuntoSeleccionado.documento)">
                                        
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn btn-sm btn-light">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                            </div>
                        </div>

                        <hr />

                        <!-- Anexos -->
                        <div>
                            <div class="d-flex justify-content-between align-items-center mb-2">
                                <h6 class="fw-bold mb-0">Anexos</h6>
                                <button class="btn btn-sm btn-outline-success" (click)="openagregarAnexosModal()">
                                    <i class="fas fa-plus me-2"></i> Agregar Anexos
                                </button>
                            </div>

                            <div *ngIf="asuntoSeleccionado.anexos.length > 0; else sinAnexos">
                                <div class="card mb-2 p-3" *ngFor="let anexo of asuntoSeleccionado.anexos">
                                    <div class="d-flex justify-content-between align-items-center">
                                        <div class="d-flex align-items-center gap-3">
                                            <i class="fas fa-paperclip fa-lg text-secondary"></i>
                                            <div>
                                                <div class="fw-semibold">{{ anexo.name }}</div>
                                                <div class="text-muted small">{{ anexo.type }} • {{ anexo.size }}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="d-flex gap-2">
                                            <button class="btn btn-sm btn-light" (click)="openDocumentoVisor(anexo)">
                                                <i class="fas fa-eye"></i>
                                            </button>
                                            <button class="btn btn-sm btn-light">
                                                <i class="fas fa-download"></i>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <ng-template #sinAnexos>
                                <p class="text-muted">No hay anexos disponibles para este asunto.</p>
                            </ng-template>
                        </div>
                    </div>
                </div>

                <!-- Asignaciones -->
                <div *ngIf="tabActiva === 'turnados'">
                    <div class="p-4">

                        <div class="d-flex justify-content-between align-items-center mb-3 ">
                            <h6 class="fw-bold mb-0">Turnados del Asunto</h6>
                            <button class="btn btn-primary  tooltip-wrapper center up" [attr.data-tooltip]="'Turnar'" (click)="openTurnarModal()">
                                <i class="fas fa-share "></i>
                            </button>
                        </div>
                    
                    <div *ngFor="let asignacion of turnados" class="card p-3 mb-2">
          <div class="d-flex justify-content-between align-items-center">
            <div class="d-flex align-items-center gap-3">
              <div class="icon-circle"><i class="fas fa-share"></i></div>
              <div>
                <p class="mb-0 fw-semibold">{{ asignacion.unidadResponsable.nombre }}</p>
                <small class="text-muted">{{ asignacion.instruccion.descripcion }}</small><br />
                <small class="text-muted">Asignado: {{ '2025-07-22 00:00'  | fechaMexico}}</small>
              </div>
            </div>
            <div class="d-flex align-items-center gap-2">              
              <button class="btn btn-sm btn-outline-secondary"><i class="fas fa-edit"></i></button>
            </div>
          </div>
        </div>
                </div>
                </div>

                <!-- Historial -->
                <div *ngIf="tabActiva === 'historial'">
                    <h6 class="fw-bold mb-3">Historial de Actividades</h6>
                    <div class="d-flex gap-3 align-items-start mb-3">
                        <div class="icon-circle bg-primary"></div>
                        <div>
                            <p class="mb-0 fw-semibold">Asunto creado</p>
                            <small class="text-muted">Por {{ asuntoSeleccionado.unidadAdministrativa }} • {{
                                asuntoSeleccionado.fechaRegistro }}</small>
                        </div>
                    </div>
                    <div class="d-flex gap-3 align-items-start mb-3">
                        <div class="icon-circle bg-success"></div>
                        <div>
                            <p class="mb-0 fw-semibold">Documentos agregados</p>
                            <small class="text-muted">{{ asuntoSeleccionado.anexos.length }} documentos • {{
                                asuntoSeleccionado.fechaRegistro }}</small>
                        </div>
                    </div>
                    <div class="d-flex gap-3 align-items-start">
                        <div class="icon-circle bg-warning"></div>
                        <div>
                            <p class="mb-0 fw-semibold">Estado actualizado</p>
                            <small class="text-muted">Cambiado a {{ asuntoSeleccionado.statusAsunto }} • Hace 2
                                días</small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>
    <ng-template #elseTemplate>
        <div class="d-flex align-items-center justify-content-center h-100">
            <p class="text-muted">Selecciona un asunto para ver los detalles</p>
        </div>
    </ng-template>
</div>



<ng-template #editarModal let-aceptar="aceptar" let-cancelar="cancelar">
    <!-- vacío por ahora -->
</ng-template>

<ng-template #turnarModal let-aceptar="aceptar" let-cancelar="cancelar">
    <div class="container-fluid  ">
    <form [formGroup]="turnadoForm">
      <div class="row">
        <div class="col-md-12">
          <label class="form-label frmlabel required" for="unidadResponsable"><i class="p-1 fas fa-building-columns"> </i>Unidad Responsable</label>
          <div class="input-icon-wrapper">
            <i
              [ngClass]="getValidationStatus(turnadoForm,'unidadResponsable') == 'valid' ? 'fas fa-check-circle icon valid-icon' : getValidationStatus(turnadoForm,'unidadResponsable') == 'invalid' ? 'fas fa-times-circle icon invalid-icon': 'd-none'"></i>
            <select
              id="unidadResponsable"
              class="form-control"
              formControlName="unidadResponsable"
              [class.invalid]="getValidationStatus(turnadoForm,'unidadResponsable') == 'invalid'"
              [class.valid]="getValidationStatus(turnadoForm,'unidadResponsable') == 'valid'"
            >
              <option [value]="null" disabled selected>Seleccione una unidad</option>
              <option *ngFor="let unidad of unidadesResponsablesDS" [value]="unidad.id">{{ unidad.nombre }}</option>
            </select>
          </div>
          <p *ngIf="getValidationStatus(turnadoForm,'unidadResponsable') == 'invalid'" class="invalid-field">Este campo es
            obligatorio.</p>
        </div>

        <div class="col-md-6">
          <label class="form-label frmlabel required" for="instruccion"><i class="p-1 fas fa-list-check"> </i>Instrucción</label>
          <div class="input-icon-wrapper">
            <i
              [ngClass]="getValidationStatus(turnadoForm,'instruccion') == 'valid' ? 'fas fa-check-circle icon valid-icon' : getValidationStatus(turnadoForm,'instruccion') == 'invalid' ? 'fas fa-times-circle icon invalid-icon': 'd-none'"></i>
            <select
              id="instruccion"
              class="form-control"
              formControlName="instruccion"
              [class.invalid]="getValidationStatus(turnadoForm,'instruccion') == 'invalid'"
              [class.valid]="getValidationStatus(turnadoForm,'instruccion') == 'valid'"
            >
              <option [value]="null" disabled selected>Seleccione una instrucción</option>
              <option *ngFor="let instr of instruccionesDS" [value]="instr.id">{{ instr.descripcion }}</option>
            </select>
          </div>
          <p *ngIf="getValidationStatus(turnadoForm,'instruccion') == 'invalid'" class="invalid-field">Este campo es
            obligatorio.</p>
        </div>

        <div class="col-md-6 d-flex flex-v-center align-items-center mt-5 align-content-center justify-content-center">
          <button class="btn btn-success" [disabled]="turnadoForm.invalid" (click)="addTurnado()">
            <i class="fas fa-plus fw-bold"></i>
          </button>
        </div>
      </div>
    </form>    

    <div class="table-responsive w-100 mx-auto" >
      <table class="table table-hover table-border-colapse ">
        <thead>
          <tr>
            <th><i class="p-1 fas fa-building-columns"></i> Unidad Responsable</th>
            <th><i class="p-1 fas fa-list-check"></i>Instrucción</th>
            <th>Borrar</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngIf="turnados.length === 0">
            <td colspan="3" class="text-center">No hay turnados agregados.</td>
          </tr>
          <tr *ngFor="let turnado of turnados; let i = index">
            <td>{{ turnado.unidadResponsable.nombre }}</td>
            <td>{{ turnado.instruccion.descripcion }}</td>
            <td class="text-center">
              <i  role="button" class="fas fa-trash text-secondary" (click)="removeTurnado(i)"></i>              
            </td>
          </tr>
        </tbody>
      </table>
    </div>    

    
    <div class="w-100 d-flex justify-content-end">
        <button class="btn btn-outline-dark m-2" (click)="cancelar()">Cancelar</button>
        <button class="btn btn-primary m-2" (click)="aceptar()">   <i class="fas fa-share m-2"></i>Turnar </button>
    </div>

  </div>
</ng-template>

<ng-template #agregarAnexosModal let-aceptar="aceptar" let-cancelar="cancelar">
    <div class="container">
       <form [formGroup]="agregarAnexoForm" (ngSubmit)="agregarAnexos()">
        <div class="mb-3">
            <div class="w-100">
            <!-- <span class="mb-2 d-block text-start frmlabel pt-0"><i class="fas fa-file-arrow-up p-2 "></i>Anexos del asunto</span> -->
            <label class="text-center w-100">
                <div
                id="drop-zone"
                class="drop-zone"
                [class.drag-over]="isDragOver"
                (dragover)="onDragOver($event)"
                (dragleave)="onDragLeave($event)"
                (drop)="onDrop(agregarAnexoForm, $event, true)"
                >
                <i class="fas fa-upload fa-3x"></i>
                <p class="mt-3 mb-0 text-muted">Haz clic o arrastra varios  archivos aquí</p>
                </div>

                <input
                multiple
                type="file"
                (change)="onFileSelectedAnexos(agregarAnexoForm, $event)"
                id="documento"
                class="hidden-input"
                >
            </label>
            </div>

            <p *ngIf="getValidationStatus(agregarAnexoForm,'documento') == 'invalid'" class="invalid-field">Debe adjuntar al menos un documento para continuar.</p>
            
        </div>
        <div class="table-responsive w-100 mx-auto" >
            <table class="table table-hover table-border-colapse ">
                <thead>
                <tr>
                    <th><i class="p-1 fas fa-file-alt"></i> Nombre del documento</th>                    
                    <th>Borrar</th>
                </tr>
                </thead>
                <tbody>
                <tr *ngIf="anexosCargados.length === 0">
                    <td colspan="3" class="text-center">No hay anexos agregados.</td>
                </tr>
                <tr *ngFor="let anexo of anexosCargados; let i = index">
                    <td>{{ anexo.name }}</td>                    
                    <td class="text-center">
                    <i  role="button" class="fas fa-trash text-secondary" (click)="borrarAnexoAgregado(i)"></i>              
                    </td>
                </tr>
                </tbody>
            </table>
        </div> 

        <div class="d-flex justify-content-end mt-4">
            <button type="submit" class="btn btn-success" [disabled]="anexosCargados.length == 0">
            <i class="fas fa-upload m-2 "></i>Cargar anexos
            </button>
        </div>
        </form>
    </div>
</ng-template>

<ng-template #confirmModal let-aceptar="aceptar" let-cancelar="cancelar">
    ¿Está seguro de que desea continuar?
</ng-template>

<ng-template #concluirModal let-aceptar="aceptar" let-cancelar="cancelar">

    <div class="container">
       <form [formGroup]="conclusionForm" (ngSubmit)="finalizarAsunto()">
      <div class="mb-3">
        <div class="w-100">
            <span class="mb-2 d-block text-start frmlabel pt-0"><i class="fas fa-file-arrow-up p-2 "></i>Documento de Cierre</span>
          <label class="text-center w-100">

            <div
              id="drop-zone"
              class="drop-zone"
              [class.drag-over]="isDragOver"
              (dragover)="onDragOver($event)"
              (dragleave)="onDragLeave($event)"
              (drop)="onDrop(conclusionForm, $event)"
            >
              <i class="fas fa-upload fa-3x"></i>
              <p class="mt-3 mb-0 text-muted">Haz clic o arrastra un archivo aquí</p>
            </div>

            <input
              type="file"
              (change)="onFileSelected(conclusionForm, $event)"
              id="documentoCierre"
              class="hidden-input"
            >
          </label>
        </div>

        <p *ngIf="getValidationStatus(conclusionForm,'documento') == 'invalid'" class="invalid-field">Debe adjuntar un documento de cierre.</p>
        
        <div *ngIf="getFileName('concluir')" class="mt-2 text-muted text-center">
        Archivo seleccionado: <strong>{{ getFileName('concluir') }}</strong>
        </div>
      </div>

      <div class="d-flex justify-content-end mt-4">
        <button type="submit" class="btn btn-success" [disabled]="conclusionForm.invalid">
          Concluir
        </button>
      </div>
    </form>
</div>

</ng-template>
<ng-template #reemplazarDocumentoModal let-aceptar="aceptar" let-cancelar="cancelar">

    <div class="container">
       <form [formGroup]="reemplazarDocumentoForm" (ngSubmit)="reemplazarDocumento()">
      <div class="mb-3">
        <div class="w-100">
            <span class="mb-2 d-block text-start frmlabel pt-0"><i class="fas fa-file-arrow-up p-2 "></i>Documento del asunto</span>
          <label class="text-center w-100">

            <div
              id="drop-zone"
              class="drop-zone"
              [class.drag-over]="isDragOver"
              (dragover)="onDragOver($event)"
              (dragleave)="onDragLeave($event)"
              (drop)="onDrop(reemplazarDocumentoForm, $event)"
            >
              <i class="fas fa-upload fa-3x"></i>
              <p class="mt-3 mb-0 text-muted">Haz clic o arrastra un archivo aquí</p>
            </div>

            <input
              type="file"
              (change)="onFileSelected(reemplazarDocumentoForm, $event)"
              id="documentoReemplazo"
              class="hidden-input"
            >
          </label>
        </div>

       <p *ngIf="getValidationStatus(reemplazarDocumentoForm,'documento') == 'invalid'" class="invalid-field">
            Debe adjuntar un documento para reemplazar.
            </p>
       <div *ngIf="getFileName('reemplazar')" class="mt-2 text-muted text-center">
        Archivo seleccionado: <strong>{{ getFileName('reemplazar') }}</strong>
        </div>
      </div>

      <div class="d-flex justify-content-end mt-4">
        <button type="submit" class="btn btn-success" [disabled]="reemplazarDocumentoForm.invalid">
          Reemplazar
        </button>
      </div>
    </form>
</div>

</ng-template>

<ng-template #verDocumentoModal let-aceptar="aceptar" let-cancelar="cancelar">
   <div class="visor">
					<div class="pdf-container">
        <div class="pdf-header p-2">
            <p class="pdf-title"><i class="fas fa-file m-2"></i> {{documentoVisor.name}}</p>
        </div>

        <!-- Aquí va el PDF embebido -->
        <embed 
           [src]="documentVisorURL" 
            type="application/pdf" 
            class="pdf-viewer"
            id="pdfViewer"
            *ngIf="documentVisorURL"
        />

        <!-- Contenido alternativo si el PDF no se puede mostrar -->
        <div class="pdf-fallback" style="display: none;" id="pdfFallback">
            <h3>No se puede mostrar el PDF</h3>
            <p>Tu navegador no soporta la visualización de archivos PDF integrados.</p>
            <a href="ruta/al/archivo.pdf" class="download-link" download>
                Descargar PDF
            </a>
        </div>

        <div class="pdf-info">
            <strong>Archivo:</strong> {{documentoVisor.name}} | 
            <strong>Tamaño:</strong> {{documentoVisor.size}} bytes| 
            <strong>Última modificación: </strong>{{documentoVisor.lastModified }} |
            <strong>Tipo: </strong>{{documentoVisor.type}}
        </div>
    </div></div>
            
</ng-template>